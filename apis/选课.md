# 选课API
## 数据结构
### 请求头
### 课程
```json
{
    "id": 736508, // 课程ID
    "nameZh": "非(软件工程)", // 教学班专业
    "nameEn": null,
    "code": "SE1701.01", // 教学班
    "teachers": [
        {
            "id": 16783, // 教师ID
            "nameZh": "****", // 教师名称
            "nameEn": "****" //教师英文名称
        }
    ],
    "course": {
        "id": 345513, // 课程ID
        "nameZh": "****", // 课程名称
        "nameEn": "****", // 课程英文名称
        "code": "SE1701", // 课程代码
        "credits": 1.0, // 学分
        "flags": [],
        "department": {
            "id": 8521, // 部门ID 
            "nameZh": "软件工程学院", // 部门名称
            "nameEn": "School of Software Engineering", //部门英文名称
            "code": "015902", // 部门代码
            "telephone": null
        } // 开课部门
    },
    "minorCourse": null,
    "courseType": {
        "id": 2028, // 课程类型ID
        "nameZh": "人类思维与学科史论", //课程类型
        "nameEn": null,
        "code": "0109" //课程类型代码
    }, // 课程类型
    "examMode": {
        "id": 35, // 考核模式
        "nameZh": "考试", //考核模式名称
        "nameEn": null,
        "code": "1" //考核模式代码
    }, // 考核类型
    "courseProperty": {
        "id": 65,
        "nameZh": "通识教育课程",
        "nameEn": null,
        "code": "TXJY"
    }, // 课程属性
    "campus": {
        "id": 7,
        "nameZh": "普陀校区",
        "nameEn": null
    }, // 校区信息
    "limitCount": 71,
    "acrossMajorLimitCount": 5,
    "acrossMajorEnable": true, // 选课限制
    "dateTimePlace": {
        "textZh": "4~9周 星期五 6~8节 普陀校区 文史楼107",
        "textEn": "4~9 Week Fri. Unit 6~Unit 8 普陀校区,文史楼107",
        "text": "4~9周 星期五 6~8节 普陀校区 文史楼107"
    }, // 时间
    "lessonKind": {
        "id": 1,
        "nameZh": "正常",
        "nameEn": "NORMAL",
        "code": "NORMAL"
    },
    "coursePackAssoc": null,
    "selectionRemark": null,
    "openDepartment": {
        "id": 8521,
        "nameZh": "软件工程学院",
        "nameEn": "School of Software Engineering",
        "code": "015902",
        "telephone": null
    }, // 开课部门
    "teachLang": {
        "id": 4,
        "nameZh": "中文",
        "nameEn": "Chinese",
        "code": "20001"
    }, // 开课语言
    "totalPeriod": 18,
    "compulsorys": [
        "ELECTIVE"
    ], // 选/必修
    "scheduleGroups": [
        {
            "id": 157804,
            "no": 0,
            "default_": true,
            "limitCount": 60,
            "dateTimePlace": {
                "textZh": "4~9周 星期五 6~8节 普陀校区 文史楼107",
                "textEn": "4~9 Week Fri. Unit 6~Unit 8 普陀校区,文史楼107",
                "text": "4~9周 星期五 6~8节 普陀校区 文史楼107"
            },
            "schedules": [
                {
                    "lessonId": 736508,
                    "scheduleGroupId": 157804,
                    "weekday": 5,
                    "startUnit": 6,
                    "endUnit": 8,
                    "startTime": 1300,
                    "entTime": 1535
                }
            ],
            "default": true
        }
    ], // 课程时间
    "hasTs": false,
    "hasCs": false,
    "virtualCost": null, // 意愿值
    "retake": false,
    "setup": false,
    "pinned": true,
    "coursePackLessonAssocs": [],
    "substituteCourseAssoc": null,
    "scheduleGroupAssoc": null,
    "substituteBuild": false,
    "needAttend": true,
    "acrossMajor": false
}
```
## 获取数据
### 获取学生ID
- URL 
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/students
- Respond
```json
{
  "result": 0,
  "message": null,
  "data": [
    000000 //学生ID
  ]
}
```
### 获取选课轮数列表
- URL
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/open-turns/{学生ID}
- Respond
```json
{
  "result": 0,
  "message": null,
  "data": [
    {
      "id": 181, // 轮次ID
      "name": "2025 秋 本科生第三轮选课", // 轮次名称
      "bulletin": "1.此轮选课为抢选，开放重修、跨选。\r\n2.“劳动与创造”课程优先开放2022级及之前的同学。\r\n3.课程编码由开课单位（学科）代码、课程编号、课程标志组成。开课单位代码一般由4位字母组成，表示开课单位或学科；课程编号由4位数字组成，分别表示修读顺序+课程类别+流水号，本科生课编码千分位为1-4。\r\n4.部分课程由于是新生课向老生开放；部分课程由于院系做了条件组设置（例如年级、专业等），不满足条件组的同学选不了。\r\n5.选课遇到问题可向院系教务员咨询。\r\n6.2025届新生不参与此轮选课。", // 说明
      "openDateTimeText": "2025-09-08 10:00~2025-09-19 16:00", // 开放时间
      "selectDateTimeText": "2025-09-09 10:00~2025-09-19 16:00", // 选课时间
      "dropDateTimeText": "2025-09-09 10:00~2025-09-19 16:00", // 退课时间
      "openDateTimeRange": {
        "startDateTime": "2025-09-08 10:00:00", // 开放时间
        "endDateTime": "2025-09-19 16:00:00" // 截至时间
      },
      "selectDateTimeRange": {
        "startDateTime": "2025-09-09 10:00:00", // 选课开放时间
        "endDateTime": "2025-09-19 16:00:00" // 选课截至时间
      },
      "dropDateTimeRange": {
        "startDateTime": "2025-09-09 10:00:00", // 退课开放时间
        "endDateTime": "2025-09-19 16:00:00" // 退课截至时间
      },
      "turnOpenTimes": [], // 轮次开放时间
      "addRulesText": [
        "允许课程替代选课",
        "不允许时间冲突（重修不受限）",
        "学生需符合选课条件组要求（重修不受限）",
        "教学班人数不得超出上限",
        "教学班选课条件组人数不得超出上限",
        "教学班上课时间组人数不得超出上限",
        "学期选课学分不得超过上限",
        "学期选课课程类型学分不得超过上限",
        "特定业务课程学期门数不得超上限",
        "同课程代码只能选一门",
        "不允许选在读课程"
      ], // 选课规则
      "dropRulesText": [], // 退课规则
      "turnMode": {
        "enablePreSelect": false, // 是否允许预选
        "enableDelayRelease": true, // 是否允许延迟释放
        "enableVirtualWallet": false,
        "showCount": false,
        "enableStudentPreset": false
      }, //选课规则
      "limitCount": null,
      "allowEnter": true,
      "disallowReasons": [], // 不允许进入原因
      "notNowTurnDropLimitCount": null,
      "capPercentage": null,
      "lowestPeople": null
    }
  ]
}
```
### 获取选课详情
- URL
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/{学生ID}/turn/{轮次ID}/select
- Respond
```json
{
  "result": 0,
  "message": null,
  "data": {
    "packCourseSelect": false,
    "retakeDisallow": true,
    "retakeExclusiveAllow": false,
    "substituteCourseRetake": true,
    "retakePassedDisallow": false,
    "conflictAgreeNotAttend": false,
    "turn": {
      "id": 181, // 轮次ID
      "bizTypeAssoc": 2,
      "semesterAssoc": 1377, // 学期关联
      "turnMode": {
        "enablePreSelect": false, // 是否允许预选
        "enableDelayRelease": true, // 是否允许延迟释放
        "enableVirtualWallet": false,
        "showCount": false,
        "enableStudentPreset": false
      }, //选课规则
      "turnTab": {
        "showPlanTab": true,
        "planTabName": "培养方案选课",
        "showPublicCourseTab": true,
        "publicCourseTabName": "通识教育-模块课程选课",
        "showAcrossMajorTab": true,
        "acrossMajorTabName": "跨选课程",
        "showRetakeTab": true,
        "retakeTabName": "重修选课",
        "showAllCourseTab": true,
        "allCourseTabName": "全部课程",
        "showSelectedTab": false,
        "selectedTabName": "已选课程",
        "showCourseTableTab": true,
        "courseTableTabName": "课表选课",
        "showSelfDeptTab": false,
        "selfDeptTabName": null,
        "showPublicCompulsoryTab": false,
        "publicCompulsoryTabName": null
      }, // 选课标签
      "name": "2025 秋 本科生第三轮选课",
      "bulletin": "1.此轮选课为抢选，开放重修、跨选。\r\n2.“劳动与创造”课程优先开放2022级及之前的同学。\r\n3.课程编码由开课单位（学科）代码、课程编号、课程标志组成。开课单位代码一般由4位字母组成，表示开课单位或学科；课程编号由4位数字组成，分别表示修读顺序+课程类别+流水号，本科生课编码千分位为1-4。\r\n4.部分课程由于是新生课向老生开放；部分课程由于院系做了条件组设置（例如年级、专业等），不满足条件组的同学选不了。\r\n5.选课遇到问题可向院系教务员咨询。\r\n6.2025届新生不参与此轮选课。",
      "topCourseSpecificFlags": [],
      "transient": false
    },
    "bizTypeId": 2,
    "semester": {
      "id": 1377, // 学期ID
      "nameZh": "2025 秋", // 学期中文名
      "nameEn": "2025-20261", // 学期英文名
      "season": "AUTUMN", // 学期季节
      "calendarId": 1
    },
    "timeTableLayoutId": 67,
    "campusId": 7, // 校区ID
    "semesterAmountUpperLimit": false,
    "semesterCreditUpperLimit": true,
    "semesterAmCreditUpperLimit": false,
    "semesterAmAmountUpperLimit": false,
    "totalAmountUpperLimit": false,
    "totalCreditUpperLimit": false,
    "semesterCourseTypeAmountUpperLimit": false,
    "semesterCourseTypeCreditUpperLimit": true,
    "totalCourseTypeAmountUpperLimit": false,
    "totalCourseTypeCreditUpperLimit": false,
    "unSignedPermission": true,
    "showRetakeCount": false,
    "semesterCourseFlagAmountUpperLimit": true,
    "semesterCourseFlagCreditUpperLimit": false,
    "totalCourseFlagAmountUpperLimit": false,
    "totalCourseFlagCreditUpperLimit": false,
    "programComplete": false,
    "delayRelease": true,
    "programId": 11774, // 培养方案ID
    "tsUrl": "https://byyt.ecnu.edu.cn/student/for-std/lesson-search/teaching-syllabus-zh/page/form/",
    "csUrl": "http://localhost:9090/mst/for-std/lesson-search/course-syllabus",
    "program": {
      "id": 11774, // 培养方案ID
      "nameZh": "****", // 培养方案中文名
      "nameEn": null,
      "majorProgram": null,
      "programType": "MAJOR", // 培养方案类型
      "season": "AUTUMN", // 季节
      "bizTypeId": 2,
      "requireCredits": 138, // 需要学分
      "requireModuleNum": -1,
      "rootModuleId": 14066
    },
    "notPinnedName": "WAIT_SCREEN",
    "selectDefaultSemester": false,
    "deptId": 8968
  }
}
```
### 获取已选课程
- URI
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/selected-lessons/{选课轮次ID}/{学生ID}
```json
{
  "result": 0,
  "message": null,
  "data": [
    // 参见课程
    // ...
  ]
}
```
### 获取筛选条件
- URL
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/query-condition/{选课轮次ID}
- Response
```json
{
  "result": 0,
  "message": null,
  "data": {
    "grades": [
      "2025"
    ], // 年级
    "departments": [
      {
        "id": 10501, // 部门ID
        "nameZh": "经济学系(不启用)", // 部门名称
        "nameEn": "Department of Economics",
        "code": "010501",
        "telephone": null
      }
    ],
    "campuses": [
      {
        "id": 6, // 校区ID 
        "nameZh": "闵行校区", //校区名称
        "nameEn": null
      },
      {
        "id": 7,
        "nameZh": "普陀校区",
        "nameEn": null
      }
    ],
    "courseTypes": [
      {
        "id": 395, // 课程类型ID
        "nameZh": "通识教育课程", // 课程类型名称
        "nameEn": "General Educational Courses",
        "code": "01" // 课程类型代码
      }
    ],
    "courseProperties": [
      {
        "id": 64, // 课程属性ID
        "nameZh": "公共必修", // 课程属性名称
        "nameEn": null,
        "code": "GGBX" // 课程属性代码
      }
    ]
  }
}
```
### 筛选课程
- URL
POST https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/query-lesson/{学生ID}/{选课轮次ID}
- Body
```json
{
  "turnId": 181, // 选课轮次ID
  "studentId": 000000, // 学生ID
  "semesterId": 1377, // 学期ID
  "pageNo": 1, // 页数
  "pageSize": 20, // 页大小
  "courseNameOrCode": "", // 课程名称
  "lessonNameOrCode": "", 
  "teacherNameOrCode": "", // 教师名称
  "week": "",
  "grade": "",
  "departmentId": "", // 部门ID
  "majorId": "", // 专业ID
  "adminclassId": "",
  "campusId": "", // 校园ID
  "openDepartmentId": "",
  "courseTypeId": "", // 课程类型ID
  "coursePropertyId": "", // 课程属性ID
  "canSelect": true, // 是否可选
  "_canSelect": "可选",
  "creditGte": null,
  "creditLte": null,
  "hasCount": null,
  "ids": [0],
  "substitutedCourseId": null,
  "courseSubstitutePoolId": null,
  "sortField": "lesson", // 排序字段
  "sortType": "ASC" //排序顺序
}
```
- Response
```json
{
  "result": 0,
  "message": null,
  "data": {
    "lessons": [
      // 参见课程
      // ...
    ],
    "pageInfo": {
      "currentPage": 1, // 当前页面
      "rowsInPage": 20, // 当前页面行数
      "rowsPerPage": 20, // 页面行数
      "totalRows": 114, // 总行数
      "totalPages": 6 // 总页数
    }, // 页面信息
    "sort__": {
      "field": "course",
      "type": "ASC"
    }
  }
}
```
### 重修查询
- URI
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/repaired-courses/{选课轮次ID}/{学生ID}
- Response
```json
{
  "result": 0,
  "message": null,
  "data": [
    {
      "id": 346205, // 课程ID
      "nameZh": "****", // 课程名称
      "nameEn": "****", //课程英文名曾
      "code": "****2", // 课程代码
      "credits": 3.0, // 课程学分
      "flags": null,
      "department": {
        "id": 8968,
        "nameZh": "数据科学与工程学院",
        "nameEn": "School of Data Science and Engineering",
        "code": "015903",
        "telephone": null
      }, // 开课部门
      "score": 45, // 分数
      "courseSelectPassStatus": "NO_PASS/PASS", // 通过状态
      "substitutedCourseAssoc": null,
      "substituteCourseProfileVms": [],
      "courseType": {
        "nameZh": "学科基础课程",
        "nameEn": "Foundation Courses for Subjects",
        "id": 399,
        "code": "02",
        "enabled": true,
        "bizTypeAssocs": [
          2
        ],
        "transient": false,
        "bizTypeIds": [
          2
        ],
        "name": "学科基础课程"
      }, // 学科类型
      "passed": false // 是否通过
    }
  ]
}
```
### 课程名额查询
- URI
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/count-info?lessonId={课程ID}
- Response
```json
{
  "result": 0,
  "message": null,
  "data": {
    "limitCount": 75, // 人数上限
    "amLimitCount": 5, // 跨专业人数上限
    "stdCount": 57, // 正选人数
    "amStdCount": 2, // 跨选人数
    "preStdCount": 0, // 预选人数
    "preAmStdCount": 0 // 跨选预选人数
  }
}
```
### 课程名额查询（批量）
- URI
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/std-count?lessonIds={课程ID1},{课程ID2}
- Response
```json
{
  "result": 0,
  "message": null,
  "data": {
    "735875": "59-2-0-2" // 课程ID:总选课人数-?-?-跨选人数
  }
}
```
## 选退课
均采用先验证后查询
### 发起验证/选退课请求
- URL
POST https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/{add/drop}-{predicate/request}
- Body
```json
{
  "studentAssoc": 828095, // 学生ID
  "courseSelectTurnAssoc": 41, // 选课轮次ID
  "requestMiddleDtos": [
    {
      "lessonAssoc": 345535, // 课程ID
      "virtualCost": 0 // 意愿值
    }
  ],
  "coursePackAssoc": null
}
```
- Response
```json
{
  "result": 0,
  "message": null,
  "data": "00000000-0000-0000-0000-000000000000" // 请求ID
}
```
### 查询验证/选退课结果
- URL
GET https://byyt.ecnu.edu.cn/course-selection-api/api/v1/student/course-select/{predicate/add-drop}-response/{学生ID}/{请求ID}
- Response
```json
{
  "result": 0,
  "message": null,
  "data": {
    "id": "00000000-0000-0000-0000-000000000000",
    "requestId": "00000000-0000-0000-0000-000000000000", // 请求ID
    "exception": null,
    "errorMessage": null, // 错误信息
    "success": true, // 结果
    "result": {
      "735304": null
    } // 课程结果
  }
}
```